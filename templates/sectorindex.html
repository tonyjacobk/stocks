<!DOCTYPE html>
<html>
<head>
    <title>Reports</title>
    <style>
        table, th, td { border: 1px solid black; border-collapse: collapse; padding: 8px; }
        .icon-link { text-decoration: none; }
        form { display: inline; }
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="header-container">
        <a href="{{ url_for('report.index', page=1) }}">Main</a>
    </div>

    <h2>Report Table</h2>
    <div class="search-container">
        <form method="GET" action="{{ url_for('sector.index', page=1) }}">
            <label for="search_by_sector">Search by Broker:</label>
            <input type="text" id="search_by_sector" name="search_by_broker" value="{{ search_by_broker or '' }}">
            <label for="search_by_company">Search by Company:</label>
            <input type="text" id="search_by_company" name="search_by_company" value="{{ search_by_company or '' }}">
            <button type="submit">Search</button>
        </form>
    </div>
    <table>
        <tr>
            <th>Company</th><th>Broker</th><th>URL</th>
	    <th>Date</th><th>Site</th><th>Actions</th>
        </tr>
        {% for row in rows %}
        <tr>
                <td>{{ row.company }} </td>
                <td>{{ row.broker }} </td>
		<td> <a href="{{ row['URL'] }}" target="_blank">
                            <img src="{{ url_for('static', filename='icon.png') }}" alt="URL Icon" width="20">
                     </a> </td>
                <td>{{ row.report_date }}</td>
		<td>{{ row.site }}</td>
		<td>
                    <form action="{{ url_for('sector.delete') }}" method="post" class="delete-form">
                        <input type="hidden" name="company" value="{{ row.company }}">
                        <input type="hidden" name="broker" value="{{ row.broker }}">
                        <input type="hidden" name="date" value="{{ row.report_date }}">
		        <input type="hidden" name="URL" value="{{ row.URL }}">


                        <button type="submit">Delete</button>
                    </form>
		    <form action="{{ url_for('sector.move') }}" method="post" class="delete-form">
                        <input type="hidden" name="company" value="{{ row.company }}">
                        <input type="hidden" name="broker" value="{{ row.broker }}">
                        <input type="hidden" name="date" value="{{ row.report_date }}">
                        <input type="hidden" name="URL" value="{{ row.URL }}">
                        <button type="submit">Move</button>
                    </form>

                </td>
        </tr>
        {% endfor %}
    </table>
    <div>
        {% if page > 1 %}
            {% if key and value %}
                <a href="{{ url_for('sector.index', page=page-1, key=key, value=value) }}">Previous</a>
            {% elif search_by_sector or search_by_company %}
                <a href="{{ url_for('sector.index', page=page-1, search_by_broker=search_by_broker, search_by_company=search_by_company) }}">Previous</a>
            {% else %}
                <a href="{{ url_for('sector.index', page=page-1) }}">Previous</a>
            {% endif %}
        {% endif %}
        <span>Page {{ page }} of {{ total_pages }}</span>
        {% if page < total_pages %}
            {% if key and value %}
                <a href="{{ url_for('sector.index', page=page+1, key=key, value=value) }}">Next</a>
            {% elif search_by_sector or search_by_company %}
                <a href="{{ url_for('sector.index', page=page+1, search_by_sector=search_by_broker, search_by_company=search_by_company) }}">Next</a>
            {% else %}
                <a href="{{ url_for('sector.index', page=page+1) }}">Next</a>
            {% endif %}
        {% endif %}
    </div>
</body>
</html>
